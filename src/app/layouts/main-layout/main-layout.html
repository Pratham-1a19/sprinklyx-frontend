<div class="h-screen flex bg-[#F8FAFD]">
  <app-sidebar class="hidden md:block h-full"></app-sidebar>

  <div class="flex-1 flex flex-col min-w-0">
    <app-header [viewMode]="viewMode" (viewModeChange)="setViewMode($event)"
      class="kt-header h-16 z-10 flex items-center bg-background border-b border-border px-6 sticky top-0">
    </app-header>

    <!-- <header app-header class="kt-header fixed top-0 z-10 start-0 end-0 flex items-stretch shrink-0 bg-background" data-kt-sticky="true" data-kt-sticky-class="border-b border-border" data-kt-sticky-name="header" id="header"></header> -->

    <main class="p-6 overflow-auto flex-1">
      <div class="flex items-center justify-between gap-4 mb-6">
        <div class="flex-1 max-w-2xl flex gap-2">
          <button *ngIf="folderHistory.length > 0" (click)="navigateUp()"
            class="p-2.5 rounded-2xl bg-gray-100 hover:bg-gray-200 transition">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
              stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M19 12H5M12 19l-7-7 7-7" />
            </svg>
          </button>
          <input placeholder="Search in Drive"
            class="w-full bg-gray-100 focus:bg-white transition shadow-sm focus:shadow-md rounded-2xl py-2.5 px-5 outline-none border-0" />
        </div>

        <!-- Actions -->
        <div class="flex items-center gap-4">

          <!-- Upload Button -->
          <button (click)="triggerUpload()"
            class="bg-primary text-white px-3 py-1.5 rounded-2xl font-medium hover:bg-primary-dark transition flex items-center gap-2">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
              stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4" />
              <polyline points="17 8 12 3 7 8" />
              <line x1="12" y1="3" x2="12" y2="15" />
            </svg>
            Upload
          </button>
          <input type="file" id="drive-upload-input" (change)="onFileSelected($event)" class="hidden">

          <!-- View Toggle -->
          <div class="flex items-center bg-gray-100 rounded-full p-1">
            <button (click)="setViewMode('grid')" class="p-2 rounded-full transition"
              [class.bg-white]="viewMode === 'grid'" [class.shadow-sm]="viewMode === 'grid'" title="Grid View">
              <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
                stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <rect x="3" y="3" width="7" height="7"></rect>
                <rect x="14" y="3" width="7" height="7"></rect>
                <rect x="14" y="14" width="7" height="7"></rect>
                <rect x="3" y="14" width="7" height="7"></rect>
              </svg>
            </button>
            <button (click)="setViewMode('list')" class="p-2 rounded-full transition"
              [class.bg-white]="viewMode === 'list'" [class.shadow-sm]="viewMode === 'list'" title="List View">
              <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
                stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <line x1="8" y1="6" x2="21" y2="6"></line>
                <line x1="8" y1="12" x2="21" y2="12"></line>
                <line x1="8" y1="18" x2="21" y2="18"></line>
                <line x1="3" y1="6" x2="3.01" y2="6"></line>
                <line x1="3" y1="12" x2="3.01" y2="12"></line>
                <line x1="3" y1="18" x2="3.01" y2="18"></line>
              </svg>
            </button>
          </div>

          <img src="/assets/media/brand-logos/google-drive.svg" class="w-7 h-7" alt="Google Drive" />
        </div>
      </div>
      <br>

      <h2 class="text-lg font-semibold mb-4">
        My Drive {{ currentFolderId !== 'root' ? '/ ...' : '' }}
      </h2>

      <div *ngIf="isLoading" class="flex justify-center p-8 text-gray-500">
        Loading files...
      </div>

      <div *ngIf="error" class="flex justify-center p-8 text-red-500 bg-red-50 rounded-lg border border-red-200">
        {{ error }}
      </div>

      <div *ngIf="!isLoading && !error"
        [class]="viewMode === 'grid' ? 'grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4' : 'flex flex-col gap-2'">

        <div *ngFor="let item of files"
          class="bg-white rounded-2xl p-4 hover:shadow-md transition cursor-pointer group relative"
          [class.flex]="viewMode === 'list'" [class.items-center]="viewMode === 'list'"
          [class.gap-4]="viewMode === 'list'">

          <img [src]="getFileIcon(item)" [class]="viewMode === 'grid' ? 'w-14 h-14 mb-3' : 'w-10 h-10'"
            class="transition group-hover:scale-110" />

          <p class="font-medium truncate">
            {{item.name}}
          </p>

          <button
            class="p-2 rounded-full hover:bg-gray-100 transition text-gray-500 hover:text-gray-700 opacity-0 group-hover:opacity-100"
            [class.absolute]="viewMode === 'grid'" [class.top-2]="viewMode === 'grid'"
            [class.right-2]="viewMode === 'grid'" [class.ml-auto]="viewMode === 'list'"
            (click)="downloadFile(item, $event)">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
              stroke="currentColor" class="w-5 h-5">
              <path stroke-linecap="round" stroke-linejoin="round"
                d="M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M7.5 10.5l4.5 4.5m0 0 4.5-4.5m-4.5 4.5V3" />
            </svg>
          </button>

        </div>

      </div>

    </main>
    <app-footer></app-footer>
  </div>
</div>